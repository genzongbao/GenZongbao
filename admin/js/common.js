$(function() {
	//表单清空
	$("#clearbtn").click(function() {
		$(':input','form')
		.not(':button, :submit, :reset, :hidden')
		.val('')
		.removeAttr('checked')
		.removeAttr('selected');
	});
	//清空时间（系统规定时间的删除按钮的name必须为remove-time）
	$("span[name=remove-time]").each(function() {
		$(this).click(function() {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
			$(this).prev().val("");
		});
	});
	//添加只能输入整数的Input事件
	if("undefined" != typeof intArray) {
		for(var i=0;i<intArray.length;i++) {
			$("input[name="+intArray[i]+"]").click(function() {
				$(this).keyup(function() {
					$(this).val($(this).val().replace(/\D/g,''));
				});
				$(this).focusout(function() {   
					$(this).val($(this).val().replace(/\D/g,''));
				});
			});
		}
	}
	//添加只能输入number的input事件
	if("undefined" != typeof numberArray) {
		//var re = /^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/;
		var re = /^\d+(\.\d+)?$/;
		for(var i=0;i<numberArray.length;i++) {
			$("input[name="+numberArray[i]+"]").focusout(function() {
				if(!re.test($(this).val())) {
					$(this).val("");
				}
			});
		}
	}
	//datepicker的生成
	if("undefined" != typeof dateArray) {
		for(var i=0;i<dateArray.length;i++) {
			$("input[name="+dateArray[i]+"]").datepicker({autoclose : true,todayHighlight : true});
		}
	}
	//datepicker的生成
	if("undefined" != typeof dateTimeArray) {
		for(var i=0;i<dateTimeArray.length;i++) {
			$("input[name="+dateTimeArray[i]+"]").datetimepicker({
				startView: 'month',
				minView: 'hour',
				format: 'yyyy-mm-dd hh:ii:00',
				autoclose: true,
				language: 'zh-CN'
			});
		}
	}
	//datepicker的生成 只能选择当前时间后面的
	if("undefined" != typeof timeArray) {
		for(var i=0;i<timeArray.length;i++) {
			$("input[name="+timeArray[i]+"]").datetimepicker({
				startView: 'month',
				minView: 'hour',
				format: 'yyyy-mm-dd hh:ii:00',
				startDate:new Date(),
				autoclose: true,
				language: 'zh-CN'
			});
		}
	}

	//消息框的关闭
	$(".close").each(function() {
		$(this).click(function() {
			$(this).parent().fadeOut();
		});
	});

	/*隐藏Bootstrap消息提示框*/
	$('.message_alert').delay(30000).hide(0);
});
/**
 * 预览图片 支持ie11 
 * @param obj 当前对象 input file 选择
 * @param id 展示图片的对象id
 * @returns
 */
window.URL = window.URL || window.webkitURL;
function handleFiles(obj,id) {
	var files = obj.files;
	var img =document.getElementById(id);
	if(window.URL){//File API
	      img.src = window.URL.createObjectURL(files[0]);   //创建一个object URL，并不是你的本地路径
	      img.onload = function(e){ window.URL.revokeObjectURL(this.src);}   //图片加载后，释放object URL
	}else if(window.FileReader){   //opera不支持createObjectURL/revokeObjectURL方法。我们用FileReader对象来处理
		var reader = new FileReader();
		reader.readAsDataURL(files[0]);
		reader.onload = function(e){img.src = this.result;}
	}else{//ie
		obj.select();
		obj.blur();
		var nfile = document.selection.createRange().text;
		document.selection.empty();
		img.src = nfile;
	}
}
/**
 * 获取fileInput的本地source
 * @param fileInputId
 * @returns
 */
function getFileSource(fileInputId) {
	var url;
	if (navigator.userAgent.indexOf("MSIE")>=1) { // IE
		url = document.getElementById(fileInputId).value;
	} else if(navigator.userAgent.indexOf("Firefox")>0) { // Firefox
		url = window.URL.createObjectURL(document.getElementById(fileInputId).files.item(0));
	} else if(navigator.userAgent.indexOf("Chrome")>0) { // Chrome
		url = window.URL.createObjectURL(document.getElementById(fileInputId).files.item(0));
	}
	return url; 
}

/**
 * 保持session的定时器
 * @param url 请求路径
 * @param time 频率（毫秒）
 */
function keepSession(url, time) {
	window.setInterval(function(){
		$.ajax({
			url:url,
			type:"POST",
			dataType:"JSON",
			data:{},
			success:function() {}
		});
	},time);
}